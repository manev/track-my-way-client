{"version":3,"file":"map.component.js","sourceRoot":"","sources":["map.component.ts"],"names":[],"mappings":"AAAA,kDAAkD;;;;;;;;;;;AAElD,8BAAoF,eAAe,CAAC,CAAA;AACpG,qBAAiC,eAAe,CAAC,CAAA;AAGjD,kCAAuB,kCAAkC,CAAC,CAAA;AAE1D,qBAAiB,qBAAqB,CAAC,CAAA;AAQvC;IAKC,sBACS,MAAiB,EACjB,QAAwB,EACxB,UAAsB,EACtB,GAAkB,EAClB,UAAsB;QAJtB,WAAM,GAAN,MAAM,CAAW;QACjB,aAAQ,GAAR,QAAQ,CAAgB;QACxB,eAAU,GAAV,UAAU,CAAY;QACtB,QAAG,GAAH,GAAG,CAAe;QAClB,eAAU,GAAV,UAAU,CAAY;QAP/B,sBAAiB,GAAG,IAAI,CAAC;QASxB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;IACtC,CAAC;IAED,+BAAQ,GAAR;QAAA,iBAuBC;QAtBA,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,UAAU,CAAC,uBAAuB,CAAC,UAAA,aAAa;YAC9C,EAAE,CAAC,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC;gBACpC,KAAI,CAAC,aAAa,EAAE,CAAC;YAChB,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,IAAI,QAAM,GAAG,qBAAK,CAAC,MAAM,CAAC,EAAE,KAAK,EAAE,mBAAmB,EAAE,OAAO,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBAC3E,KAAI,CAAC,GAAG,CAAC,OAAO,CAAC,QAAM,CAAC,CAAC;YAC7B,CAAC;YACD,KAAI,CAAC,UAAU,CAAC,wBAAwB,EAAE,CAAC;QAC/C,CAAC,CAAC,CAAC;QACA,gDAAgD;QAEtD,IAAI,CAAC,UAAU,CAAC,uBAAuB,CAAC,UAAA,IAAI;YAC3C,IAAI,OAAO,GAAG,IAAI,CAAC,SAAS,GAAG,yBAAyB,CAAC;YACzD,SAAS,CAAC,YAAY,CAAC,KAAK,CAAC,OAAO,EAAE;gBACrC,WAAW;gBACX,sBAAsB;gBAEvB,KAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YAE1B,CAAC,EAAE,EAAE,EAAE,kBAAkB,CAAC,CAAC;QAC5B,CAAC,CAAC,CAAC;IACJ,CAAC;IAEO,oCAAa,GAArB;QAAA,iBAOC;QANA,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,UAAC,WAAW,EAAE,OAAO;YACvD,EAAE,CAAC,CAAC,WAAW,CAAC;gBACf,KAAI,CAAC,OAAO,EAAE,CAAC;YAChB,IAAI;gBACH,KAAK,CAAC,OAAO,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC;IACJ,CAAC;IAEO,8BAAO,GAAf;IACA,CAAC;IArDF;QAAC,oBAAI,CAAC;YACL,WAAW,EAAE,cAAI,CAAC,cAAc,CAAC,KAAK,CAAC;SACvC,CAAC;;oBAAA;IAoDF,mBAAC;AAAD,CAAC,AAnDD,IAmDC;AAnDY,oBAAY,eAmDxB,CAAA","sourcesContent":["/// <reference path=\"../../../typings/tsd.d.ts\" />\r\n\r\nimport {Page, NavController, Alert, Modal, Loading, NavParams, ViewController} from 'ionic-angular';\r\nimport {OnInit, ElementRef} from \"@angular/core\";\r\n\r\n\r\nimport ServerHost from \"../../services/serverHostManager\";\r\nimport Settings from \"../../services/localDeviceSettings\";\r\nimport Util from \"../../services/util\";\r\nimport {User} from \"../../services/user\";\r\n\r\ndeclare var plugin: any;\r\n\r\n@Page({\r\n\ttemplateUrl: Util.GetTemplateUri(\"map\")\r\n})\r\nexport class MapComponent implements OnInit {\r\n\tprivate contact;\r\n\r\n\tisResponseWaiting = true;\r\n\r\n\tconstructor(\r\n\t\tprivate params: NavParams, \r\n\t\tprivate viewCtrl: ViewController,\r\n\t\tprivate serverHost: ServerHost,\r\n\t\tprivate nav: NavController,\r\n\t\tprivate elementRef: ElementRef) {\r\n\t\t\r\n\t\tthis.contact = params.get(\"contact\");\r\n\t}\r\n\r\n\tngOnInit(){\r\n\t\tthis.loadGoogleMap();\r\n\t\tthis.serverHost.onRequestTrackingResult(requestResult => {\r\n\t        if (requestResult.IsAccepted) {\r\n\t\t\t\tthis.loadGoogleMap();\r\n\t        } else {\r\n\t            let prompt = Alert.create({ title: \"Request cancelled\", buttons: ['OK'] });\r\n\t            this.nav.present(prompt);\r\n\t        }\r\n\t        this.serverHost.offRequestTrackingResult();\r\n\t    });\r\n        //this.serverHost.requestTracking(this.contact);\r\n\r\n\t\tthis.serverHost.onStopUserTrackRecieved(user =>  {\r\n\t\t\tvar message = user.FirstName + \" has been disconnected.\";\r\n\t\t\tnavigator.notification.alert(message, () => {\r\n\t\t\t\t// if (map)\r\n\t\t\t\t// \tmap.closeDialog();\r\n\r\n\t\t\tthis.viewCtrl.dismiss({});\r\n\t\t\t\t\r\n\t\t\t}, \"\", \"Back to contacts\");\r\n\t\t});\r\n\t}\r\n\r\n\tprivate loadGoogleMap(){\r\n\t\tplugin.google.maps.Map.isAvailable((isAvailable, message) => {\r\n\t\t\tif (isAvailable)\r\n\t\t\t\tthis.initMap();\r\n\t\t\telse\r\n\t\t\t\talert(message);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate initMap(){\r\n\t}\r\n}\r\n"]}
